import ProjectStatus from "../scalar/ProjectStatus";
import Environment from "../scalar/Environment";

function createProject(_, { input }, { dataSources: { projects, users } }) {
  const defaultNamespace = {
    name: "test-namespace-name", // How is the namespace name created? Is it from user input or is it generated by the api?
    cpuQuota: "test-cpu-quota",
    memoryQuota: "test-memory-quota",
    storageQuota: "test-storage-quota",
    snapshotQuota: "test-snapshot-quota",
  };

  const defaultProperties = {
    archived: false,
    created: new Date(),
    productionNamespace: {
      environment: Environment.PRODUCTION,
      ...defaultNamespace,
    },
    testNamespace: { environment: Environment.TEST, ...defaultNamespace },
    developmentNamespace: {
      environment: Environment.PROD,
      ...defaultNamespace,
    },
    toolsNamespace: { environment: Environment.TOOLS, ...defaultNamespace },
    requestHistory: [],
    status: ProjectStatus.SUBMITTED,
  };

  // Find owner and technical lead user documents and add prject id to the document
  users.updateById(id, updateProp)
  // addToSet (mongo)

  return projects.create({ ...input, ...defaultProperties });
}

export default createProject;
